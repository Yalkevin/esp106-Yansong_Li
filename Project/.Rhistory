htmlwidgets::saveWidget(as_widget(Clean_Energy_Investment_Percentage), "Clean_Energy_Investment_Percentage.html")
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Europe_Energy_Investment, x = ~Europe_Energy_Investment$Year, y = ~Europe_Energy_Investment$Renewable, type = 'bar',text = Europe_Energy_Investment$Renewable, textposition = 'auto',marker = list(
line = list(color = 'white', width = 1.5)), name = 'Renewable Investment')
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Europe_Energy_Investment$Fossil,text = Europe_Energy_Investment$Fossil, textposition = 'auto',marker = list(
line = list(color = 'white', width = 1.5)), name = 'Fossil Fuel Investment')
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(yaxis = list(title = '$Billion'), barmode = 'stack')
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(title = "Europe Renewable Vs. Fossil Fuel Investment",
xaxis = list(title = "Year"),
yaxis = list(title = "$Billion"))
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Euro_RenewableVFossil <- c(Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
View(Europe_Renewable_VS_Fossil_Energy_Investment)
Euro_RenewableVFossil <- as.data.frame(c(Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels))
View(Euro_RenewableVFossil)
Euro_RenewableVFossil <- as.data.frame(c(Europe_Energy_Investment[Europe_Energy_Investment$Renewable],Europe_Energy_Investment[Europe_Energy_Investment$Fossil_fuels]))
Euro_RenewableVFossil <- as.data.frame(c(Europe_Energy_Investment[,Europe_Energy_Investment$Renewable],Europe_Energy_Investment[,Europe_Energy_Investment$Fossil_fuels]))
Euro_RenewableVFossil <- as.data.frame(c(Europe_Energy_Investment[(,Europe_Energy_Investment$Renewable)],Europe_Energy_Investment[(,Europe_Energy_Investment$Fossil_fuels)]))
Euro_RenewableVFossil <- Europe_Energy_Investment[,"Renewable"]
Euro_RenewableVFossil <- as.data.frame(Europe_Energy_Investment[,"Renewable"])
Euro_RenewableVFossil <- as.data.frame(c(Europe_Energy_Investment[,"Year"],Europe_Energy_Investment[,"Renewable"],Europe_Energy_Investment[,"Fossil_fuels"]))
Euro_RenewableVFossil <- as.data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar", marker = list(color = 'green'))
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar", marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar", marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment', marker = list(color = 'lightgrey'))
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar", marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion (2021)"),
margin = list(b = 100),
barmode="group")
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar", marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion (2021)"),
margin = list(b = 100))
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar", marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion (2021)"),
margin = list(b = 100),barmode = 'group')
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar", marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion"),
margin = list(b = 100),barmode = 'group')
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar",text = Euro_RenewableVFossil$Europe_Energy_Investment.Renewable , textposition = 'auto',marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion"),
margin = list(b = 100),barmode = 'group')
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar",text = Euro_RenewableVFossil$Europe_Energy_Investment.Renewable , textposition = 'auto',marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment',text = Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels , textposition = 'auto', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion"),
margin = list(b = 100),barmode = 'group')
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
View(Monthly_Energy_Statistics)
View(EU_Yearly_Renewables_Generation)
View(France_Annual_Renewable_Energy_Generation)
View(Germany_Annual_Renewable_Energy_Generation_Data)
View(EU_Yearly_Renewables_Generation)
knitr::opts_chunk$set(echo = TRUE)
#Set working directory (be sure to change wording directory on another computer)
knitr::opts_knit$set(root.dir = "D:/UC Davis/Courses and Research/My Courses/ESP 106/Assignment/esp106-Yansong_Li/Project/Data")
list.files(getwd())
unzip(list.files(getwd()))
list.files(getwd())
list.files("Edited Data")
list.of.packages <- c("ggplot2", "readxl","tidyr","magrittr","dplyr","plotly")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(ggplot2)
library(readxl)
library(tidyr)
library(magrittr)
library(dplyr)
library(plotly)
list.files("Edited Data")
World_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "World"))
Europe_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "Europe"))
#Monthly Energy Price Statistics
Monthly_Oil_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Table"))
Germany_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Germany Energy Prices"))
France_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "France Energy Price"))
#OPEC Reliance on Russia Fuel
OPEC_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "Reliance_Fuel"))
France_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "French Reliance on Russia"))
Germany_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "Germnay Reliance on Russia"))
Germany_Gas_Trade_Flows <- as.data.frame(read_xls("Edited Data/Gas Trade Flows _17_02_2023.xls", sheet = "To Germany"))
World_Energy_Balance <- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx",skip=1, sheet = "TimeSeries_1971-2021"))
France_Energy_Balance <- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx", sheet = "France"))
Germany_Energy_Balance<- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx", sheet = "Germany"))
gc()
gc()
knitr::opts_chunk$set(echo = TRUE)
#Set working directory (be sure to change wording directory on another computer)
knitr::opts_knit$set(root.dir = "D:/UC Davis/Courses and Research/My Courses/ESP 106/Assignment/esp106-Yansong_Li/Project/Data")
list.files(getwd())
unzip(list.files(getwd()))
list.files(getwd())
list.files("Edited Data")
list.of.packages <- c("ggplot2", "readxl","tidyr","magrittr","dplyr","plotly")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(ggplot2)
library(readxl)
library(tidyr)
library(magrittr)
library(dplyr)
library(plotly)
list.files("Edited Data")
World_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "World"))
Europe_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "Europe"))
#Monthly Energy Price Statistics
Monthly_Oil_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Table"))
Germany_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Germany Energy Prices"))
France_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "France Energy Price"))
#OPEC Reliance on Russia Fuel
OPEC_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "Reliance_Fuel"))
France_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "French Reliance on Russia"))
Germany_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "Germnay Reliance on Russia"))
Germany_Gas_Trade_Flows <- as.data.frame(read_xls("Edited Data/Gas Trade Flows _17_02_2023.xls", sheet = "To Germany"))
World_Energy_Balance <- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx",skip=1, sheet = "TimeSeries_1971-2021"))
France_Energy_Balance <- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx", sheet = "France"))
Germany_Energy_Balance<- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx", sheet = "Germany"))
EU_Yearly_Renewables_Generation <- as.data.frame(read.csv("Edited Data/EU Yearly Renewables Generation .csv"))
France_Annual_Renewable_Energy_Generation<- as.data.frame(read.csv("Edited Data/France Annual Renewable Energy Generation Data.csv"))
Germany_Annual_Renewable_Energy_Generation_Data <- as.data.frame(read.csv("Edited Data/Germany Annual Renewable Energy Generation Data.csv"))
Monthly_Energy_Statistics <- as.data.frame(read.csv("Edited Data/Monthly Energy Statistics.csv",skip = 8))
Monthly_Gas_statistics <- as.data.frame(read.csv("Edited Data/Monthly Gas statistics.csv"))
Monthly_OECD_oil_statistics <-as.data.frame(read.csv("Edited Data/Monthly OECD oil statistics.csv"))
# Energy balance Data
colnames(France_Energy_Balance)
France_Energy_Balance <- France_Energy_Balance %>% gather(Year, Energy, 4:54)
colnames(Germany_Energy_Balance)
Germany_Energy_Balance <- Germany_Energy_Balance %>% gather(Year, Energy, 4:54)
colnames(World_Energy_Balance)
World_Energy_Balance <- World_Energy_Balance %>% gather(Year, Energy, 7:57)
# Monthly Oil Statistics
colnames(Monthly_Oil_Statistics)
Monthly_Oil_Statistics <- Monthly_Oil_Statistics %>% gather(Year, Price, 5:101)
#Reliance on Russia Import
colnames(OPEC_Reliance_on_Russian_imports)
OPEC_Reliance_on_Russian_imports <- OPEC_Reliance_on_Russian_imports %>% gather(Year, Reliance, 3:34)
France_Reliance_on_Russian_imports$Reliance <- France_Reliance_on_Russian_imports$Reliance*100
colnames(France_Reliance_on_Russian_imports) <- c("YEAR","COUNTRY","PRODUCT","Reliance %")
Germany_Reliance_on_Russian_imports$Reliance <- Germany_Reliance_on_Russian_imports$Reliance*100
colnames(Germany_Reliance_on_Russian_imports) <- c("YEAR","COUNTRY","PRODUCT","Reliance %")
World_Energy_Balance[World_Energy_Balance ==".."] <- NA
Germany_Energy_Balance[Germany_Energy_Balance ==".."] <- NA
France_Energy_Balance[France_Energy_Balance ==".."] <- NA
France_Energy_Balance[France_Energy_Balance =="c"] <- NA
# c stands for confidential
#We first try to sum up the renewable energy investment from the three categories
World_Energy_Investment$Renewable <- World_Energy_Investment$`Renewables(Generation)`+World_Energy_Investment$`Renewables (Supply)`+World_Energy_Investment$`Other end-use renewables  (End-use)`
Europe_Energy_Investment$Renewable <- Europe_Energy_Investment$`Renewables(Generation)`+Europe_Energy_Investment$`Renewables (Supply)`+Europe_Energy_Investment$`Other end-use renewables  (End-use)`
#we then make a plot showing the trends of renewable energy investment of Europe and the World
Renewable_Investment <- plot_ly(Europe_Energy_Investment,x= ~Europe_Energy_Investment$Year, y= ~Europe_Energy_Investment$Renewable, type = "scatter",name = 'Europe Renewable Investment', mode = 'lines+markers')
Renewable_Investment <- Renewable_Investment %>% add_trace(y = ~World_Energy_Investment$Renewable, name = 'World Renewable Investment', mode = 'lines+markers')
Renewable_Investment <- Renewable_Investment %>% layout(title = "Europe and the World Renewable Energy Investment 2015-2022",
yaxis=list(title="$Billions"),
xaxis=list(title="Year"))
Renewable_Investment
htmlwidgets::saveWidget(as_widget(Renewable_Investment), "Renewable_Investment.html")
Clean_Energy_Investment <- plot_ly(Europe_Energy_Investment, x = Europe_Energy_Investment$Year, y = Europe_Energy_Investment$`Total (billion $2021)`, type = 'bar', name = 'Totale Energy Investment(2021)', marker = list(color = 'blue'))
Clean_Energy_Investment <- Clean_Energy_Investment %>% add_trace(y = Europe_Energy_Investment$`Total Investment of which: Clean energy`, name = 'Clean Energy Investment', marker = list(color = 'green'))
Clean_Energy_Investment <- Clean_Energy_Investment %>% layout(title = "Europe Total and Clean Energy Investment 2015-2022",
yaxis = list(title = "$Billions"),
xaxis = list(title = "Year"))
Clean_Energy_Investment
htmlwidgets::saveWidget(as_widget(Clean_Energy_Investment), "Clean_Energy_Investment.html")
# This plot shows the percentage of clean energy in relation to total energy investment
Europe_Energy_Investment$Clean_Energy_Percentage <- Europe_Energy_Investment$`Total Investment of which: Clean energy`/Europe_Energy_Investment$`Total (billion $2021)`* 100
Clean_Energy_Investment_Percentage <- plot_ly(Europe_Energy_Investment, x = ~Europe_Energy_Investment$Year, y = ~Europe_Energy_Investment$Clean_Energy_Percentage, name = '% of Totle Energy Investment in Clean Energy', type = 'scatter',mode='lines+markers')
Clean_Energy_Investment_Percentage <- Clean_Energy_Investment_Percentage %>% layout(title = " Total Europe Energy investement as clean energy Investment 2015-2022(%)",
yaxis = list(title = "% of Totle Energy Investment in Clean Energy"),
xaxis = list(title = "Year"))
Clean_Energy_Investment_Percentage
htmlwidgets::saveWidget(as_widget(Clean_Energy_Investment_Percentage), "Clean_Energy_Investment_Percentage.html")
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar",text = Euro_RenewableVFossil$Europe_Energy_Investment.Renewable , textposition = 'auto',marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment',text = Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels , textposition = 'auto', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion"),
margin = list(b = 100),barmode = 'group')
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
View(Monthly_Energy_Statistics)
View(Monthly_Oil_Statistics)
head(EU_Yearly_Renewables_Generation)
View(France_Annual_Renewable_Energy_Generation)
View(France_Energy_Balance)
View(Euro_RenewableVFossil)
View(EU_Yearly_Renewables_Generation)
as.factor(EU_Yearly_Renewables_Generation$variable)
levels(as.factor(EU_Yearly_Renewables_Generation$variable))
EU_Yearly_Renewables_Generation[EU_Yearly_Renewables_Generation$variable != "Fossil" & EU_Yearly_Renewables_Generation$variable != "Clean" & EU_Yearly_Renewables_Generation$variable != "Wind and solar" ]
EU_Yearly_Renewables_Generation[EU_Yearly_Renewables_Generation$variable != "Fossil" & EU_Yearly_Renewables_Generation$variable != "Clean" & EU_Yearly_Renewables_Generation$variable != "Wind and solar" ,]
levels(as.factor(EU_Yearly_Renewables_Generation$variable))
EU_Yearly_Renewables_Generation[EU_Yearly_Renewables_Generation$variable != "Fossil" & EU_Yearly_Renewables_Generation$variable != "Clean" & EU_Yearly_Renewables_Generation$variable != "Wind and solar" ,]
levels(as.factor(EU_Yearly_Renewables_Generation$variable))
EU_Yearly_Renewables_Generation <- EU_Yearly_Renewables_Generation[EU_Yearly_Renewables_Generation$variable != "Fossil" & EU_Yearly_Renewables_Generation$variable != "Clean" & EU_Yearly_Renewables_Generation$variable != "Wind and solar" ,]
levels(as.factor(EU_Yearly_Renewables_Generation$variable))
levels(as.factor(Germany_Annual_Renewable_Energy_Generation_Data$variable))
levels(as.factor(EU_Yearly_Renewables_Generation$variable))
levels(as.factor(France_Annual_Renewable_Energy_Generation$variable))
levels(as.factor(Germany_Annual_Renewable_Energy_Generation_Data$variable))
# We can see that the data set contains 12 different classifications energy. However, if we look more carefully, we can see that "Clean","Wind and Solar", and "Fossil" are just the sum of different combinations of other energy types. Therefore, we need to first remove the rows containing these three classifications from the data.
EU_Yearly_Renewables_Generation <- EU_Yearly_Renewables_Generation[EU_Yearly_Renewables_Generation$variable != "Fossil" & EU_Yearly_Renewables_Generation$variable != "Clean" & EU_Yearly_Renewables_Generation$variable != "Wind and solar" ,]
France_Annual_Renewable_Energy_Generation <- France_Annual_Renewable_Energy_Generation[France_Annual_Renewable_Energy_Generation$variable != "Fossil" & France_Annual_Renewable_Energy_Generation$variable != "Clean" & France_Annual_Renewable_Energy_Generation$variable != "Wind and solar" ,]
Germany_Annual_Renewable_Energy_Generation_Data <- Germany_Annual_Renewable_Energy_Generation_Data[Germany_Annual_Renewable_Energy_Generation_Data$variable != "Fossil" & Germany_Annual_Renewable_Energy_Generation_Data$variable != "Clean" & Germany_Annual_Renewable_Energy_Generation_Data$variable != "Wind and solar" ,]
View(Germany_Annual_Renewable_Energy_Generation_Data)
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$variable, fill=group)) +
geom_area()
EU_Energy_Profile
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=group)) +
geom_area()
EU_Energy_Profile
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=group)) +
geom_area()
EU_Energy_Profile
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()
EU_Energy_Profile
th <- theme_bw(base_size=20)+theme(strip.background
th <- theme_bw(base_size=20)+theme(strip.background =element_rect(fill="white"))
th <- theme_bw(base_size=20)+theme(strip.background =element_rect(fill="white"))
th <- theme_bw(base_size=20)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th
EU_Energy_Profile
th <- theme_bw(base_size=2)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th
EU_Energy_Profile
th <- theme_bw(base_size=5)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th
EU_Energy_Profile
th <- theme_bw(base_size=10)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years", color="EU_Yearly_Renewables_Generation$variable")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years", color="EU_Yearly_Renewables_Generation$variable")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years", color="EU_Yearly_Renewables_Generation$variable")+scale_fill_discrete(name = "Energy Generation Type")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years", color="EU_Yearly_Renewables_Generation$variable")+scale_fill_discrete(name = "Energy Generation Types")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+geom_area(alpha=0.6 , size=.5, colour="white") +
scale_fill_viridis(discrete = T) +
theme_ipsum() +
ggtitle("EU Energy Generation PRofile")
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years", color="EU_Yearly_Renewables_Generation$variable")+scale_fill_discrete(name = "Energy Generation Types")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years", color="EU_Yearly_Renewables_Generation$variable")+scale_fill_discrete(name = "Energy Generation Types")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")++scale_fill_discrete(name = "Energy Generation Types")
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+ labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+th+ labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+ labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area(stat="identity")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
list.files(getwd())
unzip(list.files(getwd()))
list.files("Edited Data")
list.of.packages <- c("ggplot2", "readxl","tidyr","magrittr","dplyr","plotly","hrbrthemes ")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(ggplot2)
library(readxl)
library(tidyr)
library(magrittr)
library(dplyr)
library(plotly)
library(hrbrthemes)
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()
EU_Energy_Profile
EU_Energy_Profile <- EU_Energy_Profile+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+ scale_color_manual(values=c('chartreuse4', 'gray30','gray69',"royalblue2","magenta3","wheat4","green","greenyellow","lightskyblue"))+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
EU_Energy_Profile <- EU_Energy_Profile+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()
EU_Energy_Profile <- EU_Energy_Profile+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile <- EU_Energy_Profile+ scale_color_manual(values=c(""))
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable)) +
geom_area()+
scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil"))
EU_Energy_Profile <- EU_Energy_Profile+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile <- EU_Energy_Profile+ scale_color_manual(values=c(""))
EU_Energy_Profile
th <- theme_bw(base_size=7)+theme(strip.background =element_rect(fill="white"))
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+
scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +
geom_area()
EU_Energy_Profile <- EU_Energy_Profile+th+labs(y="Annual Energy Production of EU (terawatt-hour)",
x="Years")+scale_fill_discrete(name = "Energy Generation Types")
EU_Energy_Profile <- EU_Energy_Profile+ scale_color_manual(values=c(""))
EU_Energy_Profile
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+
scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +
geom_area()
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+
scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +
geom_area()
EU_Energy_Profile
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+
scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +
geom_area()+scale_color_manual(values=c("skyblue","yellow2","chartreuse3","dodgerblue2","green3","orchid3","grey20","grey80","wheat4"))
EU_Energy_Profile
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+scale_color_manual(values=c("skyblue","yellow2","chartreuse3","dodgerblue2","green3","orchid3","grey20","grey80","wheat4"))
+scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +
geom_area()
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+scale_color_manual(values=c("skyblue","yellow2","chartreuse3","dodgerblue2","green3","orchid3","grey20","grey80","wheat4"))
+scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +geom_area()
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+scale_color_manual(values=c("skyblue","yellow2","chartreuse3","dodgerblue2","green3","orchid3","grey20","grey80","wheat4"))+scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +geom_area()
EU_Energy_Profile
knitr::opts_chunk$set(echo = TRUE)
#Set working directory (be sure to change wording directory on another computer)
knitr::opts_knit$set(root.dir = "D:/UC Davis/Courses and Research/My Courses/ESP 106/Assignment/esp106-Yansong_Li/Project/Data")
list.files(getwd())
unzip(list.files(getwd()))
list.files(getwd())
list.files("Edited Data")
list.of.packages <- c("ggplot2", "readxl","tidyr","magrittr","dplyr")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(ggplot2)
library(readxl)
library(tidyr)
library(magrittr)
library(dplyr)
library(plotly)
list.files("Edited Data")
World_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "World"))
Europe_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "Europe"))
#Monthly Energy Price Statistics
Monthly_Oil_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Table"))
Germany_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Germany Energy Prices"))
France_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "France Energy Price"))
#OPEC Reliance on Russia Fuel
OPEC_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "Reliance_Fuel"))
France_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "French Reliance on Russia"))
Germany_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "Germnay Reliance on Russia"))
Germany_Gas_Trade_Flows <- as.data.frame(read_xls("Edited Data/Gas Trade Flows _17_02_2023.xls", sheet = "To Germany"))
World_Energy_Balance <- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx",skip=1, sheet = "TimeSeries_1971-2021"))
France_Energy_Balance <- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx", sheet = "France"))
Germany_Energy_Balance<- as.data.frame(read_xlsx("Edited Data/World Energy Balances Highlights 2022.xlsx", sheet = "Germany"))
EU_Yearly_Renewables_Generation <- as.data.frame(read.csv("Edited Data/EU Yearly Renewables Generation .csv"))
France_Annual_Renewable_Energy_Generation<- as.data.frame(read.csv("Edited Data/France Annual Renewable Energy Generation Data.csv"))
Germany_Annual_Renewable_Energy_Generation_Data <- as.data.frame(read.csv("Edited Data/Germany Annual Renewable Energy Generation Data.csv"))
Monthly_Energy_Statistics <- as.data.frame(read.csv("Edited Data/Monthly Energy Statistics.csv",skip = 8))
Monthly_Gas_statistics <- as.data.frame(read.csv("Edited Data/Monthly Gas statistics.csv"))
Monthly_OECD_oil_statistics <-as.data.frame(read.csv("Edited Data/Monthly OECD oil statistics.csv"))
# Energy balance Data
colnames(France_Energy_Balance)
France_Energy_Balance <- France_Energy_Balance %>% gather(Year, Energy, 4:54)
colnames(Germany_Energy_Balance)
Germany_Energy_Balance <- Germany_Energy_Balance %>% gather(Year, Energy, 4:54)
colnames(World_Energy_Balance)
World_Energy_Balance <- World_Energy_Balance %>% gather(Year, Energy, 7:57)
# Monthly Oil Statistics
colnames(Monthly_Oil_Statistics)
Monthly_Oil_Statistics <- Monthly_Oil_Statistics %>% gather(Year, Price, 5:101)
#Reliance on Russia Import
colnames(OPEC_Reliance_on_Russian_imports)
OPEC_Reliance_on_Russian_imports <- OPEC_Reliance_on_Russian_imports %>% gather(Year, Reliance, 3:34)
France_Reliance_on_Russian_imports$Reliance <- France_Reliance_on_Russian_imports$Reliance*100
colnames(France_Reliance_on_Russian_imports) <- c("YEAR","COUNTRY","PRODUCT","Reliance %")
Germany_Reliance_on_Russian_imports$Reliance <- Germany_Reliance_on_Russian_imports$Reliance*100
colnames(Germany_Reliance_on_Russian_imports) <- c("YEAR","COUNTRY","PRODUCT","Reliance %")
World_Energy_Balance[World_Energy_Balance ==".."] <- NA
Germany_Energy_Balance[Germany_Energy_Balance ==".."] <- NA
France_Energy_Balance[France_Energy_Balance ==".."] <- NA
France_Energy_Balance[France_Energy_Balance =="c"] <- NA
# c stands for confidential
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
# This plot shows the percentage of clean energy in relation to total energy investment
Europe_Energy_Investment$Clean_Energy_Percentage <- Europe_Energy_Investment$`Total Investment of which: Clean energy`/Europe_Energy_Investment$`Total (billion $2021)`* 100
Clean_Energy_Investment_Percentage <- plot_ly(Europe_Energy_Investment, x = ~Europe_Energy_Investment$Year, y = ~Europe_Energy_Investment$Clean_Energy_Percentage, name = '% of Totle Energy Investment in Clean Energy', type = 'scatter',mode='lines+markers')
Clean_Energy_Investment_Percentage <- Clean_Energy_Investment_Percentage %>% layout(title = " Total Europe Energy investement as clean energy Investment 2015-2022(%)",
yaxis = list(title = "% of Totle Energy Investment in Clean Energy"),
xaxis = list(title = "Year"))
Clean_Energy_Investment_Percentage
htmlwidgets::saveWidget(as_widget(Clean_Energy_Investment_Percentage), "Clean_Energy_Investment_Percentage.html")
Europe_Energy_Investment$Fossil_fuels <- Europe_Energy_Investment$`Fossil fuels without CCUS (Supply)`+Europe_Energy_Investment$`Fossil fuels(Fuels)`+Europe_Energy_Investment$`Coal (Generation)`+Europe_Energy_Investment$`Oil and natural gas(Generation)`+Europe_Energy_Investment$`Memo: Oil & gas upstream`
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
Europe_Renewable_VS_Fossil_Energy_Investment <- plot_ly(Euro_RenewableVFossil, x = ~Euro_RenewableVFossil$Europe_Energy_Investment.Year, y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Renewable, name = 'Renewable Investments', type = "bar",text = Euro_RenewableVFossil$Europe_Energy_Investment.Renewable , textposition = 'auto',marker = list(color = 'lightgreen'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% add_trace(y = ~Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels, name = 'Fossil Fuel Investment',text = Euro_RenewableVFossil$Europe_Energy_Investment.Fossil_fuels , textposition = 'auto', marker = list(color = 'lightgrey'))
Europe_Renewable_VS_Fossil_Energy_Investment <- Europe_Renewable_VS_Fossil_Energy_Investment %>% layout(xaxis = list(title = "Year", tickangle = -45),
yaxis = list(title = "$Billion"),
margin = list(b = 100),barmode = 'group')
htmlwidgets::saveWidget(as_widget(Europe_Renewable_VS_Fossil_Energy_Investment), "Europe_Renewable_VS_Fossil_Energy_Investment.html")
Europe_Renewable_VS_Fossil_Energy_Investment
Euro_RenewableVFossil <- data.frame(Europe_Energy_Investment$Year,Europe_Energy_Investment$Renewable,Europe_Energy_Investment$Fossil_fuels)
levels(as.factor(EU_Yearly_Renewables_Generation$variable))
levels(as.factor(France_Annual_Renewable_Energy_Generation$variable))
levels(as.factor(Germany_Annual_Renewable_Energy_Generation_Data$variable))
# We can see that the data set contains 12 different classifications energy. However, if we look more carefully, we can see that "Clean","Wind and Solar", and "Fossil" are just the sum of different combinations of other energy types. Therefore, we need to first remove the rows containing these three classifications from the data.
EU_Yearly_Renewables_Generation <- EU_Yearly_Renewables_Generation[EU_Yearly_Renewables_Generation$variable != "Fossil" & EU_Yearly_Renewables_Generation$variable != "Clean" & EU_Yearly_Renewables_Generation$variable != "Wind and solar" ,]
France_Annual_Renewable_Energy_Generation <- France_Annual_Renewable_Energy_Generation[France_Annual_Renewable_Energy_Generation$variable != "Fossil" & France_Annual_Renewable_Energy_Generation$variable != "Clean" & France_Annual_Renewable_Energy_Generation$variable != "Wind and solar" ,]
Germany_Annual_Renewable_Energy_Generation_Data <- Germany_Annual_Renewable_Energy_Generation_Data[Germany_Annual_Renewable_Energy_Generation_Data$variable != "Fossil" & Germany_Annual_Renewable_Energy_Generation_Data$variable != "Clean" & Germany_Annual_Renewable_Energy_Generation_Data$variable != "Wind and solar" ,]
EU_Energy_Profile <- ggplot(EU_Yearly_Renewables_Generation, aes(x=EU_Yearly_Renewables_Generation$year, y=EU_Yearly_Renewables_Generation$generation_twh, fill=EU_Yearly_Renewables_Generation$variable))+scale_color_manual(values=c("skyblue","yellow2","chartreuse3","dodgerblue2","green3","orchid3","grey20","grey80","wheat4"))+scale_fill_discrete(breaks=c("Wind", "Solar", "Bioenergy","Hydro","Other Renewables","Nuclear","Coal","Gas","Other Fossil")) +geom_area()
EU_Energy_Profile
