---
title: "ESP 106 Final Project"
author: "Yansong Li","Veronica Herrera"
date: "2023-03-06"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#Set working directory (be sure to change wording directory on another computer)
knitr::opts_knit$set(root.dir = 'D:/UC Davis/Courses and Research/My Courses/ESP 106/Assignment/esp106-Yansong_Li/Project/Data')

```

#Setup
```{r}

#Download and unzip the zipped data file into the working directory
wd=getwd()
unzip("Edited Data-20230307T041349Z-001.zip")
list.files(getwd())
list.files("Edited Data")

#We have to do some slight adjustment to the data's formatting to make it easier to work with, but the data content are not changed

if (!find.package("readxl")){
  download.packages("readxl")
  library(readxl)
} else if (find.package("readxl")){
  library(readxl)
} 
# Also download the necessary package to read the data file
```
# Introduction
This project will focus on explore trends in energy production and consumption since the start of the Russia- Ukraine War that started in 2022. Our Analysis will focus on the energy production, import, and export of Russia, and countries of focus within the EU, specifically Germany and France. 

Other countries, such as China, was originally considered, however, there were issues in obtaining time relevant data, which is data from 2021 to the end of 2022. Indeed, when collecting data for this project, finding time relevant data for many topics were challenging, and data are usually more available for Economic Co-operation and Development (OECD) countries than non-OECD ones. 

# Data
```{r Data}
# we first try to load all the data into Rstudio as Dataframes
list.files("Edited Data")
#Excel files
World_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "World"))

Europe_Energy_Investment <- as.data.frame(read_xlsx("Edited Data/2022 World Energy Investment .xlsx", sheet = "Europe"))

Monthly_Oil_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Table"))

Germany_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "Germany Energy Prices"))

France_Monthly_Oil_Price_Statistics <- as.data.frame(read_xlsx("Edited Data/Monthly Oil Statistics.xlsx", sheet = "France Energy Price"))

France_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "French Reliance on Russia"))

Germany_Reliance_on_Russian_imports <- as.data.frame(read_xlsx("Edited Data/Reliance on Russian imports.xlsx", sheet = "Germnay Reliance on Russia"))

Germany_Gas_Trade_Flows <- as.data.frame(read_xls("Edited Data/Gas Trade Flows _17_02_2023.xls", sheet = "To Germany"))

#csv file
EU_Yearly_Renewables_Generation <- as.data.frame(read.csv("Edited Data/EU Yearly Renewables Generation .csv"))

France_Annual_Renewable_Energy_Generation<- as.data.frame(read.csv("Edited Data/France Annual Renewable Energy Generation Data.csv"))

Germany_Annual_Renewable_Energy_Generation_Data <- as.data.frame(read.csv("Edited Data/Germany Annual Renewable Energy Generation Data.csv"))

Monthly_Energy_Statistics <- as.data.frame(read.csv("Edited Data/Monthly Energy Statistics.csv",skip = 8))

Monthly_Gas_statistics <- as.data.frame(read.csv("Edited Data/Monthly Gas statistics.csv"))

Monthly_OECD_oil_statistics <-as.data.frame(read.csv("Edited Data/Monthly OECD oil statistics.csv"))

```


# Context

```{r World Map}

```

```{r EU/Russian Area Extent}

```

```{r Reliance on Russian Gas}

```

# What are the EU {Countries of Interest( France and Germany)} and Russia's energy import and export prior to the Russian Invasion of Ukraine?
```{r Energy France (Import, Export) by-product}

```

```{r Energy Germany (Import, Export) by product}

```

```{r Energy  Russia (Import, Export) by product}

```

# What are the trends in fossil fuel (coal, oil, and natural gas) energy production, exports, and imports in the European Union since the Russian Invasion of Ukraine? (Feb 2022 to present)

```{r Fossil Fuel Import (3 trend lines - oil vs. gas vs. coal) }

```

```{r Fossil Fuel Export (3 trend lines - oil vs. gas vs. coal)}

```

# What are the trends of renewable energy investments in the COI after the start of the Russian Invasion of Ukraine?

```{r 2022 Fossil Fuel Investment vs Renewable Energy Investment }

```

# What are the trend in renewable energy (Solar, Wind, Hydro) production since the Ukrainian war?

```{r}

```

# Does the Ukrainian war have any impact on nuclear power production in the EU(Focused countries)

```{r}

```

# What is the trend of oil prices and consumption?

```{r}

```

Conclusion

